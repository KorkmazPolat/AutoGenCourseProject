<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{{ course_title }} | Course Bundle</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 24px;
        background: #f0f4f8;
        color: #1f2933;
      }
      main {
        max-width: 900px;
        margin: 0 auto;
        background: #ffffff;
        padding: 24px;
        border: 1px solid #d2d6dc;
      }
      h1,
      h2,
      h3 {
        margin-top: 24px;
      }
      h1 {
        margin-top: 0;
      }
      section {
        margin-bottom: 32px;
      }
      ul {
        padding-left: 18px;
      }
      .muted {
        color: #52606d;
        font-size: 0.9rem;
      }
      .module {
        border: 1px solid #d2d6dc;
        padding: 12px;
        margin-bottom: 12px;
        background: #f8fafc;
      }
      video {
        max-width: 100%;
        margin-top: 8px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 12px;
      }
      table th,
      table td {
        border: 1px solid #d2d6dc;
        padding: 8px;
        text-align: left;
      }
      a.back {
        text-decoration: none;
        color: #2563eb;
      }
    </style>
  </head>
  <body>
    <main>
      <a class="back" href="/">&larr; back</a>
      <h1>{{ course_title }}</h1>
      <p class="muted">This is an early draft view with all the generated pieces laid out simply.</p>

      <section>
        <h2>Course basics</h2>
        <ul>
          {% if audience %}<li><strong>Audience:</strong> {{ audience }}</li>{% endif %}
          {% if tone %}<li><strong>Tone:</strong> {{ tone }}</li>{% endif %}
          {% if duration_minutes %}<li><strong>Target video length:</strong> {{ duration_minutes }} minutes</li>{% endif %}
        </ul>
        {% if learning_outcomes %}
        <h3>Learning outcomes</h3>
        <ul>
          {% for outcome in learning_outcomes %}
          <li>{{ outcome }}</li>
          {% endfor %}
        </ul>
        {% endif %}
      </section>

      <section>
        <h2>Module roadmap</h2>
        {% if blueprint and blueprint.modules %}
        {% for module in blueprint.modules %}
        <div class="module">
          <h3>Module {{ module.number }}: {{ module.title }}</h3>
          {% if module.summary %}<p>{{ module.summary }}</p>{% endif %}
          {% if module.outcomes %}
          <p><strong>Focus outcomes:</strong> {{ module.outcomes | join(", ") }}</p>
          {% endif %}
          {% if module.key_topics %}
          <p><strong>Key topics:</strong> {{ module.key_topics | join(", ") }}</p>
          {% endif %}
          {% if module.learning_activities %}
          <p><strong>Activities:</strong></p>
          <ul>
            {% for activity in module.learning_activities %}
            <li>
              {{ activity.activity_type }} — {{ activity.description }}
              {% if activity.duration_minutes %}({{ activity.duration_minutes }} min){% endif %}
              {% if activity.outcome_alignment %}<br /><span class="muted">Outcome: {{ activity.outcome_alignment }}</span>{% endif %}
            </li>
            {% endfor %}
          </ul>
          {% endif %}
          {% if module.assessment %}
          <p><strong>Assessment:</strong> {{ module.assessment.format }} — {{ module.assessment.description }}</p>
          {% endif %}
          {% if module.resources %}
          <p><strong>Resources:</strong> {{ module.resources | join(", ") }}</p>
          {% endif %}
          {% if module.project_milestone %}
          <p><strong>Project milestone:</strong> {{ module.project_milestone }}</p>
          {% endif %}
        </div>
        {% endfor %}
        {% else %}
        <p>No module outline was generated.</p>
        {% endif %}
      </section>

      {% set video = video_material.get("content") if video_material else None %}
      {% if video %}
      <section>
        <h2>Video script</h2>
        {% if video_url %}
        <video controls src="{{ video_url }}"></video>
        {% elif video_material.get("video_file") %}
        <p><a href="{{ video_url }}">Download video</a></p>
        {% endif %}
        {% if video.hook %}<p><strong>Hook:</strong> {{ video.hook }}</p>{% endif %}
        {% if video.outline %}
        <h3>Outline</h3>
        <ul>
          {% for item in video.outline %}
          <li>{{ item.timestamp }} — {{ item.topic }}</li>
          {% endfor %}
        </ul>
        {% endif %}
        {% if video.narration %}
        <h3>Narration</h3>
        <ul>
          {% for block in video.narration %}
          <li><strong>{{ block.section }}</strong>: {{ block.summary }}<br />{{ block.script }}</li>
          {% endfor %}
        </ul>
        {% endif %}
        {% if video.recap %}<p><strong>Recap:</strong> {{ video.recap }}</p>{% endif %}
        {% if video.call_to_action %}<p><strong>Call to action:</strong> {{ video.call_to_action }}</p>{% endif %}
      </section>
      {% endif %}

      {% set reading = materials.get("reading_material", {}).get("content") %}
      {% if reading %}
      <section>
        <h2>Reading handout</h2>
        {% if reading.summary %}<p><strong>Summary:</strong> {{ reading.summary }}</p>{% endif %}
        {% if reading.sections %}
        <h3>Sections</h3>
        <ul>
          {% for section in reading.sections %}
          <li>
            <strong>{{ section.heading }}</strong>
            {% if section.key_points %}
            <ul>
              {% for point in section.key_points %}
              <li>{{ point }}</li>
              {% endfor %}
            </ul>
            {% endif %}
            <p>{{ section.content }}</p>
            {% if section.outcome_alignment %}
            <p class="muted">Outcomes: {{ section.outcome_alignment | join(", ") }}</p>
            {% endif %}
          </li>
          {% endfor %}
        </ul>
        {% endif %}
        {% if reading.examples %}
        <h3>Examples</h3>
        <ul>
          {% for example in reading.examples %}
          <li>
            <strong>{{ example.title }}</strong> — {{ example.description }}
            {% if example.outcome_alignment %}
            <span class="muted">(Outcomes: {{ example.outcome_alignment | join(", ") }})</span>
            {% endif %}
          </li>
          {% endfor %}
        </ul>
        {% endif %}
        {% if reading.glossary %}
        <h3>Glossary</h3>
        <ul>
          {% for term in reading.glossary %}
          <li><strong>{{ term.term }}</strong>: {{ term.definition }}</li>
          {% endfor %}
        </ul>
        {% endif %}
        {% if reading.reflections %}
        <h3>Reflection prompts</h3>
        <ul>
          {% for prompt in reading.reflections %}
          <li>{{ prompt }}</li>
          {% endfor %}
        </ul>
        {% endif %}
      </section>
      {% endif %}

      {% set quiz = materials.get("quiz_questions", {}).get("content") %}
      {% if quiz %}
      <section>
        <h2>Quiz questions</h2>
        {% if quiz.questions %}
        <ol>
          {% for question in quiz.questions %}
          <li>
            <p><strong>{{ question.stem }}</strong></p>
            <ul>
              {% for choice in question.choices %}
              <li>{{ choice.label }}. {{ choice.text }}</li>
              {% endfor %}
            </ul>
            <p class="muted">Answer: {{ question.answer }} — {{ question.rationale }}</p>
            {% if question.learning_outcome %}<p class="muted">Outcome: {{ question.learning_outcome }}</p>{% endif %}
          </li>
          {% endfor %}
        </ol>
        {% endif %}
        {% if quiz.remediation %}
        <p><strong>Remediation tip:</strong> {{ quiz.remediation }}</p>
        {% endif %}
      </section>
      {% endif %}

      {% set project = materials.get("project_assignment", {}).get("content") %}
      {% if project %}
      <section>
        <h2>Project assignment</h2>
        <p>{{ project.scenario }}</p>
        {% if project.tasks %}
        <h3>Tasks</h3>
        <ol>
          {% for task in project.tasks %}
          <li>
            {{ task.instructions }}
            {% if task.outcome_alignment %}
            <span class="muted">(Outcome: {{ task.outcome_alignment }})</span>
            {% endif %}
          </li>
          {% endfor %}
        </ol>
        {% endif %}
        {% if project.deliverables %}
        <h3>Deliverables</h3>
        <ul>
          {% for item in project.deliverables %}
          <li>{{ item }}</li>
          {% endfor %}
        </ul>
        {% endif %}
        {% if project.rubric %}
        <h3>Rubric</h3>
        <table>
          <thead>
            <tr>
              <th>Criterion</th>
              <th>Levels</th>
            </tr>
          </thead>
          <tbody>
            {% for criterion in project.rubric %}
            <tr>
              <td>{{ criterion.criterion }}</td>
              <td>
                {% for level in criterion.levels %}
                <div><strong>{{ level.level }}:</strong> {{ level.description }}</div>
                {% endfor %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        {% endif %}
        {% if project.checklist %}
        <h3>Checklist</h3>
        <ul>
          {% for item in project.checklist %}
          <li>{{ item }}</li>
          {% endfor %}
        </ul>
        {% endif %}
        {% if project.stretch_goal %}
        <h3>Stretch goal</h3>
        <p>{{ project.stretch_goal }}</p>
        {% endif %}
      </section>
      {% endif %}

      <p class="muted">All content is generated automatically. Adjust inputs and regenerate as needed.</p>
    </main>
  </body>
</html>
