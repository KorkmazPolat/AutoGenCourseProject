{% extends "base.html" %}

{% block title %}Course Generator - ALPHA{% endblock %}

{% block head %}
  {{ super() }}
  {% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto bg-white p-8 md:p-10 rounded-2xl shadow-xl animate-fadeIn">
    
    <div class="text-left mb-8">
        <h1 class="text-3xl font-bold text-gray-800">Course Generator</h1>
        <p class="text-gray-600 text-lg mt-2">Enter your course details and watch it come to life!</p>
    </div>

    <form id="course-form" method="post" action="/create-course-plan" class="space-y-6">
        
        <div>
            <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-4">Core Details</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-gray-700 font-semibold mb-1" for="course_title">Course Title</label>
                    <input id="course_title" name="course_title" type="text" 
                           placeholder="e.g., Introduction to Python" 
                           class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-400 focus:outline-none" 
                           value="{{ values.get('course_title','') }}" required>
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-1" for="audience">Audience</label>
                    <input id="audience" name="audience" type="text" 
                           placeholder="e.g., Beginner developers" 
                           class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-400 focus:outline-none" 
                           value="{{ values.get('audience','') }}">
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-1" for="tone">Tone</label>
                    <input id="tone" name="tone" type="text" 
                           placeholder="e.g., Professional and engaging" 
                           class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-400 focus:outline-none" 
                           value="{{ values.get('tone','') }}">
                </div>
                 <div>
                    <label class="block text-gray-700 font-semibold mb-1" for="duration_minutes">Target Duration (Minutes)</label>
                    <input id="duration_minutes" name="duration_minutes" type="number" 
                           placeholder="e.g., 10 (for a single video)" 
                           class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-400 focus:outline-none" 
                           value="{{ values.get('duration_minutes','') }}">
                </div>
            </div>
        </div>

        <div>
            <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-4">Source Material (PDF)</h2>
             <div>
                <label class="block text-gray-700 font-semibold mb-1" for="document-dropzone">Upload Course Materials</label>
                <div id="document-dropzone" class="flex flex-col items-center justify-center gap-2 border-2 border-dashed border-indigo-200 bg-indigo-50/40 rounded-xl py-6 px-4 text-center text-indigo-900 transition-all duration-300 ease-in-out cursor-pointer hover:border-indigo-400 hover:bg-indigo-50">
                    <input id="document-input" type="file" accept="application/pdf" class="hidden">
                    <svg class="w-10 h-10 text-indigo-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                    </svg>
                    <p class="text-sm font-semibold">Drag & drop a PDF here</p>
                    <p class="text-sm text-indigo-600">
                      or
                      <button type="button" id="document-browse" class="font-semibold underline underline-offset-4 hover:text-indigo-800">browse files</button>
                    </p>
                    <p class="text-xs text-indigo-500">Upload source material to ground the AI outputs.</p>
                </div>
                <p id="document-status" class="mt-2 text-sm text-gray-500">No document uploaded yet.</p>
            </div>
        </div>

        <div>
            <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-4">Learning Outcomes</h2>
            <div>
                <label class="block text-gray-700 font-semibold mb-1" for="learning_outcomes">Outcomes</label>
                <textarea id="learning_outcomes" name="learning_outcomes" rows="5" 
                          placeholder="- Explain why prompt design matters&#10;- Compare prompting patterns&#10;- Use prompts to debug failures" 
                          class="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-400 focus:outline-none" required>{{ values.get('learning_outcomes','') }}</textarea>
                <p class="text-xs text-gray-500 mt-1">Enter one outcome per line. This is crucial for generation.</p>
            </div>
        </div>

        <div class="pt-6 border-t">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">Generate Course</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3">
                
                <button type="submit" 
                        class="px-4 py-3 font-semibold rounded-xl text-white bg-blue-600 hover:bg-blue-700 shadow-md transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                    Create Course Plan
                </button>
                
                <button type="submit" formaction="/create-course-pages" 
                        class="px-4 py-3 font-semibold rounded-xl text-purple-700 border border-purple-600 hover:bg-purple-50 transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2">
                    Build Module Pages
                </button>
                <button type="submit" formaction="/create-course-video" 
                        class="px-4 py-3 font-semibold rounded-xl text-purple-700 border border-purple-600 hover:bg-purple-50 transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2">
                    Generate Video
                </button>
                
                <button type="submit" formaction="/create-full-course" 
                        class="px-4 py-3 font-semibold rounded-xl text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2">
                    Create Full Course
                </button>
            </div>
        </div>
    </form>
</div>

<div id="loading-overlay" class="hidden fixed inset-0 bg-white/95 flex flex-col items-center justify-center z-50">
    <div class="bg-white p-8 rounded-2xl shadow-xl w-96 max-w-[90vw] text-center animate-fadeIn">
        <h2 class="text-2xl font-bold mb-4">Creating your content…</h2>
        <div class="w-full h-4 bg-gray-200 rounded-full overflow-hidden">
            <div id="progress-bar" class="h-full w-0 bg-gradient-to-r from-blue-500 to-purple-500"></div>
        </div>
        <p id="progress-text" class="mt-2 font-mono text-gray-700">0%</p>
        <p id="progress-hint" class="mt-2 text-gray-500">Drafting materials…</p>
    </div>
</div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="{{ url_for('static', path='main.js') }}" defer></script>
{% endblock %}