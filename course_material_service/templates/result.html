{% extends "base.html" %}

{% block title %}{{ course_title }} - Result - ALPHA{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto bg-white shadow-2xl rounded-2xl p-8 md:p-10 mb-10 animate-fadeIn">

  <div class="flex flex-col md:flex-row items-center justify-between mb-8">
    <div>
      <h1 class="text-3xl font-bold text-gray-800 mb-2">{{ course_title }}</h1>
      {% if hook %}
      <p class="text-gray-600 italic">{{ hook }}</p>
      {% endif %}
    </div>
    <a href="/dashboard" class="mt-4 md:mt-0 bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition">Back to Dashboard</a>
  </div>

  {% if video_url %}
  <div class="mb-8">
      <video controls preload="metadata" class="w-full rounded-xl shadow-lg">
          <source src="{{ video_url }}" type="video/mp4" />
          {% if captions_url %}
          <track kind="subtitles" src="{{ captions_url }}" srclang="en" label="English" default />
          {% endif %}
          {% if chapters_url %}
          <track kind="chapters" src="{{ chapters_url }}" srclang="en" label="Chapters" />
          {% endif %}
      </video>
      <p class="text-gray-500 text-sm mt-2">Voice: {{ voice }} | Model: {{ model }} | File: {{ video_file }}</p>
  </div>
  {% else %}
  <p class="text-red-600 font-semibold mb-8">No video file was generated.</p>
  {% endif %}

  {% if rag_context %}
  <div class="mb-8">
    <h2 class="text-2xl font-bold mb-3 text-gray-800">Source Context</h2>
    <div class="bg-gray-50 border border-gray-200 rounded-xl p-4 max-h-64 overflow-y-auto">
      <pre class="whitespace-pre-wrap text-sm text-gray-700 font-mono">{{ rag_context }}</pre>
    </div>
  </div>
  {% endif %}

  <div class="mb-8">
    <h2 class="text-2xl font-bold mb-4 text-gray-800">Course Outline</h2>
    {% if outline %}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      {% for item in outline %}
      <div class="bg-gray-50 p-4 rounded-xl shadow hover:shadow-lg transition cursor-pointer">
        <p class="font-semibold text-gray-700">{{ item.timestamp }}</p>
        <p class="text-gray-600">{{ item.topic }}</p>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <p class="text-gray-500">No outline was returned.</p>
    {% endif %}
  </div>

</div>
{% endblock %}